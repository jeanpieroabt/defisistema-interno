<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1974CE">
    <title>Historial - Defi Oracle</title>
                    <script>
        const __storedApi = localStorage.getItem('apiBaseUrlOverride');
        const __fallbackApi = (location.protocol === 'file:' ? 'http://localhost:3000' : location.origin);
        if (typeof window.API_BASE_URL !== 'string' || window.API_BASE_URL.length === 0) {
            window.API_BASE_URL = __storedApi || __fallbackApi;
        }
    </script>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .hist-header {
            background: var(--bg-white);
            padding: var(--space-xl);
            display: flex;
            align-items: center;
            gap: var(--space-md);
            border-bottom: 1px solid var(--border-light);
        }

        .btn-back {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            padding: var(--space-xs);
        }

        .hist-header-title {
            font-size: var(--font-h2);
            font-weight: var(--font-semibold);
        }

        .hist-filters {
            padding: var(--space-lg);
            background: var(--bg-white);
        }

        .filter-chips {
            display: flex;
            gap: var(--space-sm);
            overflow-x: auto;
            padding-bottom: var(--space-sm);
        }

        .filter-chip {
            padding: var(--space-sm) var(--space-md);
            background: var(--light-bg);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-full);
            font-size: var(--font-small);
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
        }

        .filter-chip.active {
            background: var(--primary-blue);
            color: white;
            border-color: var(--primary-blue);
        }

        .hist-content {
            padding: var(--space-lg);
        }

        .hist-group {
            margin-bottom: var(--space-xl);
        }

        .hist-date {
            font-size: var(--font-small);
            color: var(--neutral-gray);
            font-weight: var(--font-medium);
            margin-bottom: var(--space-md);
            padding-left: var(--space-sm);
        }

        .hist-card {
            background: var(--bg-white);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-sm);
            cursor: pointer;
            transition: all 0.2s;
        }

        .hist-card:hover {
            box-shadow: var(--shadow-md);
        }

        .hist-card-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .hist-avatar {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: var(--secondary-blue);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: var(--font-semibold);
            color: var(--primary-blue);
        }

        .hist-info {
            flex: 1;
        }

        .hist-name {
            font-weight: var(--font-medium);
        }

        .hist-method {
            font-size: var(--font-caption);
            color: var(--neutral-gray);
        }

        .hist-amount {
            text-align: right;
        }

        .hist-clp {
            font-weight: var(--font-semibold);
        }

        .hist-ves {
            font-size: var(--font-caption);
            color: var(--neutral-gray);
        }

        .hist-card-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-light);
        }

        .hist-code {
            font-size: var(--font-caption);
            color: var(--neutral-gray);
            font-family: monospace;
        }

        .hist-status {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: var(--font-small);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-sm);
        }

        .hist-status.completado {
            background: #D1FAE5;
            color: #059669;
        }

        .hist-status.pendiente {
            background: #FEF3C7;
            color: #D97706;
        }

        .hist-status.procesando {
            background: var(--secondary-blue);
            color: var(--primary-blue);
        }

        .hist-status.cancelado {
            background: #FEE2E2;
            color: #DC2626;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--space-3xl);
        }

        .empty-icon {
            font-size: 64px;
            margin-bottom: var(--space-lg);
        }

        .empty-title {
            font-size: var(--font-h2);
            font-weight: var(--font-semibold);
            margin-bottom: var(--space-sm);
        }

        .empty-text {
            color: var(--neutral-gray);
            margin-bottom: var(--space-xl);
        }

        /* Detail Modal */
        .detail-header {
            text-align: center;
            padding: var(--space-xl);
            border-bottom: 1px solid var(--border-light);
        }

        .detail-status-icon {
            font-size: 48px;
            margin-bottom: var(--space-md);
        }

        .detail-title {
            font-size: var(--font-h2);
            font-weight: var(--font-semibold);
        }

        .detail-body {
            padding: var(--space-xl);
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: var(--space-md) 0;
            border-bottom: 1px solid var(--border-light);
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: var(--neutral-gray);
        }

        .detail-value {
            font-weight: var(--font-medium);
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="page">
            <!-- Header -->
            <header class="hist-header">
                <button class="btn-back" onclick="volver()">â†</button>
                <h1 class="hist-header-title">Historial de envÃ­os</h1>
            </header>

            <!-- Filters -->
            <div class="hist-filters">
                <div class="filter-chips">
                    <button class="filter-chip active" data-filter="todos" onclick="filtrar('todos')">Todos</button>
                    <button class="filter-chip" data-filter="completado" onclick="filtrar('completado')">Completados</button>
                    <button class="filter-chip" data-filter="pendiente" onclick="filtrar('pendiente')">Pendientes</button>
                    <button class="filter-chip" data-filter="procesando" onclick="filtrar('procesando')">En proceso</button>
                </div>
            </div>

            <!-- Content -->
            <main class="hist-content" id="histContent">
                <!-- Se llena dinÃ¡micamente -->
            </main>

            <!-- Empty State -->
            <div class="empty-state" id="emptyState" style="display: none;">
                <div class="empty-icon">ðŸ“­</div>
                <h2 class="empty-title">Sin envÃ­os</h2>
                <p class="empty-text">AÃºn no has realizado ningÃºn envÃ­o</p>
                <button class="btn btn-primary" onclick="window.location.href='enviar.html'">Hacer mi primer envÃ­o</button>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div class="modal-backdrop" id="detailModal" style="display: none;">
        <div class="modal" style="max-height: 80vh; overflow-y: auto;">
            <div class="detail-header">
                <div class="detail-status-icon" id="detailStatusIcon">âœ…</div>
                <h3 class="detail-title" id="detailTitle">EnvÃ­o completado</h3>
            </div>
            <div class="detail-body">
                <div class="detail-row">
                    <span class="detail-label">CÃ³digo</span>
                    <span class="detail-value" id="detailCode">-</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Fecha</span>
                    <span class="detail-value" id="detailFecha">-</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Destinatario</span>
                    <span class="detail-value" id="detailDestinatario">-</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Banco</span>
                    <span class="detail-value" id="detailBanco">-</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">MÃ©todo</span>
                    <span class="detail-value" id="detailMetodo">-</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Monto enviado</span>
                    <span class="detail-value" id="detailMontoCLP">-</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Tasa aplicada</span>
                    <span class="detail-value" id="detailTasa">-</span>
                </div>
                <div class="detail-row">
                    <span class="detail-label">Monto recibido</span>
                    <span class="detail-value" id="detailMontoVES" style="color: var(--accent-green); font-size: 18px;">-</span>
                </div>
            </div>
            <div style="padding: 0 var(--space-xl) var(--space-xl);">
                <button class="btn btn-primary" style="width: 100%;" onclick="cerrarModal()">Cerrar</button>
            </div>
        </div>
    </div>

            
</body>
</html>











